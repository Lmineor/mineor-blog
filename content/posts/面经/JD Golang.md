---
title: JD面经
date: 2025-04-05
draft: 
tags:
  - 面经
---
# 线上报了软件使用内存过大，怎么去定位哪里出现了问题



# 内存泄露发生的可能情况

## 数组的错误使用
由于数组是Golang的基本数据类型，每个数组占用不同的内存空间，生命周期互不干扰，很难出现内存泄漏的情况。但是数组作为形参传输时，遵循的是值拷贝，如果函数被多次调用且数组过大时，则会导致内存使用激增。

```text
//统计nums中target出现的次数
func countTarget(nums [1000000]int, target int) int {
    num := 0
    for i := 0; i < len(nums) && nums[i] == target; i++ {
        num++
    }
    return num
}
```

例如上面的函数中，每次调用countTarget函数传参时都需要新建一个大小为100万的int数组，大约为8MB内存，如果在短时间内调用100次就需要约800MB的内存空间了。（未达到GC时间或者GC阀值是不会触发GC的）如果是在高并发场景下每个协程都同时调用该函数，内存占用量是非常恐怖的。

对于大数组放在形参场景下，通常使用切片或者指针进行传递，避免短时间的内存使用激增。

// go垃圾回收
// go多线程，多进程怎么用，与go routing的区别
// 工作中与同事争论，怎么去解决争论